<!-- 自定义导航栏 -->
<view class="nav-bar">
  <view class="nav-status-bar" style="height: {{statusBarHeight}}px;"></view>
  <view class="nav-title-area">
    <view class="nav-title">创建</view>
  </view>
</view>

<!-- 滚动内容区域 -->
<scroll-view
  class="create-scroll-wrapper"
  style="height: calc(100vh - {{statusBarHeight + 44}}px - 130rpx); top: {{statusBarHeight + 44}}px;"
  scroll-y
>
  <view class="create-page">
    <view class="form-container">

    <!-- 顶部装饰 -->
    <view class="form-header">
      <text class="header-emoji">✨</text>
      <text class="header-text">时光记录</text>
    </view>

    <!-- 活动名称 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-emoji">📌</text>
        <text class="label-text">名称</text>
        <text class="required-mark">*</text>
      </view>
      <input
        class="form-input"
        placeholder="给这次活动起个名字吧~"
        value="{{title}}"
        bindinput="onTitleChange"
        maxlength="50"
      />
    </view>

    <!-- 活动描述 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-emoji">📝</text>
        <text class="label-text">描述</text>
      </view>
      <textarea
        class="form-textarea"
        placeholder="描述"
        value="{{description}}"
        bindinput="onDescriptionChange"
        maxlength="500"
        auto-height
      />
    </view>

    <!-- 日期时间 -->
    <view class="form-item-row">
      <view class="form-item-half">
        <view class="form-label">
          <text class="label-emoji">📅</text>
          <text class="label-text">日期</text>
          <text class="required-mark">*</text>
        </view>
        <picker
          mode="date"
          value="{{date}}"
          bindchange="onDateChange"
        >
          <view class="picker-box {{date ? 'has-value' : ''}}">
            {{date || '选择日期'}}
          </view>
        </picker>
      </view>
      <view class="form-item-half">
        <view class="form-label">
          <text class="label-emoji">⏰</text>
          <text class="label-text">时间</text>
        </view>
        <picker
          mode="time"
          value="{{time}}"
          bindchange="onTimeChange"
        >
          <view class="picker-box {{time ? 'has-value' : ''}}">
            {{time || '选择时间'}}
          </view>
        </picker>
      </view>
    </view>

    <!-- 地点 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-emoji">📍</text>
        <text class="label-text">地点</text>
      </view>
      <input
        class="form-input"
        placeholder="在哪里度过这段时光？"
        value="{{location}}"
        bindinput="onLocationChange"
        maxlength="100"
      />
    </view>

    <!-- 图片上传 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-emoji">📷</text>
        <text class="label-text">照片</text>
        <text class="required-mark">*</text>
      </view>
      <t-upload
        mediaType="{{['image']}}"
        max="{{9}}"
        gridConfig="{{uploadGridConfig}}"
        files="{{images}}"
        bind:add="onUploadAdd"
        bind:remove="onUploadRemove"
      />
      <view class="form-tip">☁️ 最多上传9张照片</view>
    </view>

    <!-- 参与人员 -->
    <view class="form-item">
      <view class="form-label">
        <text class="label-emoji">👥</text>
        <text class="label-text">参与人</text>
      </view>
      <view class="participants-grid">
        <view
          class="participant-option {{item.selected ? 'selected' : ''}}"
          wx:for="{{participantOptions}}"
          wx:key="name"
          bindtap="onToggleParticipant"
          data-name="{{item.name}}"
        >
          <text class="option-emoji">{{item.emoji}}</text>
          <text class="option-name">{{item.name}}</text>
          <text class="option-check" wx:if="{{item.selected}}">✓</text>
        </view>
      </view>
    </view>

  </view>
  </view>
</scroll-view>

<!-- 底部提交按钮 -->
<view class="submit-bar">
  <view class="submit-btn" bindtap="onSubmit" wx:if="{{!submitting}}">
    <text class="submit-icon"></text>
    <text class="submit-text">发布</text>
  </view>
  <view class="submit-btn sending" wx:else>
    <text class="submit-icon">🎀</text>
    <text class="submit-text">发布中...</text>
  </view>
</view>
