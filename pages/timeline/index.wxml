<scroll-view
  class="timeline-scroll-wrapper"
  scroll-y
>
  <view class="container">
  <!-- çŠ¶æ€æ å ä½ -->
  <!-- <view class="status-bar-spacer" style="height: {{statusBarHeight}}px;"></view> -->

  <!-- æ—¶å…‰çº¿åˆ—è¡¨ -->
  <view class="timeline-container" wx:if="{{!loading && memories.length > 0}}">
    <block wx:for="{{memories}}" wx:key="_id">
      <view class="timeline-item" bindtap="goToDetail" data-id="{{item._id}}">
        <view class="memory-card">
          <!-- å¡ç‰‡è£…é¥°æ˜Ÿæ˜Ÿ -->
          <view class="card-star star-1">â­</view>
          <view class="card-star star-2">âœ¨</view>

          <!-- å›¾ç‰‡åŒºåŸŸ -->
          <view class="card-image-wrapper">
            <image class="card-image" src="{{item.images[0]}}" mode="aspectFill"></image>
            <view class="image-shadow"></view>
          </view>

          <!-- å†…å®¹åŒºåŸŸ -->
          <view class="card-body">
            <!-- æœ€ç»ˆå¾—åˆ†å°ç«  -->
            <view class="card-rating-stamp {{item.averageRatingLabel === 'æ‹‰å®Œäº†' || item.averageRatingLabel === 'æ‹‰' || item.averageRatingLabel === 'npc' ? 'stamp-low' : ''}}" wx:if="{{item.averageRatingLabel}}">
              {{item.averageRatingLabel}}
            </view>

            <view class="card-title">{{item.title}}</view>

            <view class="card-meta" wx:if="{{item.date}}">
              <text class="meta-icon">ğŸ“…</text>
              <text class="meta-text">{{item.date}}</text>
            </view>

            <view class="card-meta" wx:if="{{item.location}}">
              <text class="meta-icon">ğŸ“</text>
              <text class="meta-text">{{item.location}}</text>
            </view>

            <view class="card-meta" wx:if="{{item.participants && item.participants.length > 0}}">
              <text class="meta-icon">ğŸ‘¥</text>
              <text class="meta-text">
                <text wx:for="{{item.participants}}" wx:key="index" wx:for-item="p">{{p}}{{index < item.participants.length - 1 ? 'ã€' : ''}}</text>
              </text>
            </view>

            <view class="card-desc" wx:if="{{item.description}}">
              {{item.description}}
            </view>
          </view>
        </view>
      </view>
    </block>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && memories.length === 0}}">
    <view class="empty-icon">ğŸŒ¸</view>
    <view class="empty-title">è¿˜æ²¡æœ‰è®°å½•å“¦</view>
    <view class="empty-desc">ç‚¹å‡»å³ä¸‹è§’æŒ‰é’®ï¼Œå¼€å§‹è®°å½•ç¾å¥½æ—¶å…‰å§~</view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-icon">ğŸ€</view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>
  </view>
</scroll-view>

<!-- æ–°å»ºæŒ‰é’® -->
<view class="add-button" bindtap="toggleActionMenu">
  <view class="add-btn-inner">
    <text class="add-icon">âœï¸</text>
  </view>
  <view class="add-btn-shadow"></view>
</view>

<!-- æ“ä½œèœå• -->
<view class="action-menu-mask {{showActionMenu ? 'show' : ''}}" bindtap="closeActionMenu"></view>
<view class="action-menu {{showActionMenu ? 'show' : ''}}">
  <view class="menu-item" bindtap="goToAdd">
    <text class="menu-icon">â•</text>
    <text class="menu-text">æ–°å»ºè®°å½•</text>
  </view>
  <view class="menu-item" bindtap="toggleSort">
    <text class="menu-icon">{{sortBy === 'happenTime' ? 'â°' : 'ğŸ•'}}</text>
    <text class="menu-text">{{sortBy === 'happenTime' ? 'æŒ‰åˆ›å»ºæ—¶é—´æ’åº' : 'æŒ‰å‘ç”Ÿæ—¶é—´æ’åº'}}</text>
  </view>
</view>
